# 管理ダッシュボード設計書 - カフェPWAデモアプリ

## 1. 概要
本ドキュメントは、カフェPWAデモアプリの管理ダッシュボードの設計仕様を定めるものです。
顧客用PWAと連携し、店舗運営に必要な機能を提供します。

## 2. 設計方針

### 2.1 基本方針
- **対象デバイス**: タブレット優先、スマートフォン対応
- **デザインシステム**: shadcn/ui（ビジネス向けのプロフェッショナルなUI）
- **カラーテーマ**: グレー基調のクリーンなデザイン
- **データ連携**: 顧客用PWAとLocalStorageを共有してリアルタイム連携をシミュレート
- **レスポンシブ設計**: タブレット（768px以上）とスマホ（768px未満）で最適化

### 2.2 技術スタック
#### ビルドツール・フレームワーク
- **Vite**: 高速なビルドツール（顧客用PWAと統一）
  - HMR（Hot Module Replacement）で快適な開発体験
  - TypeScriptサポート標準搭載
  - 本番ビルドの最適化
- **React 18**: UIライブラリ
- **TypeScript**: 型安全な開発

#### UIコンポーネント・スタイリング
- **shadcn/ui**: RadixUIとTailwind CSSベースのコンポーネントライブラリ
  - ビジネス向けのプロフェッショナルなデザイン
  - 高いカスタマイズ性
  - アクセシビリティ対応
- **Tailwind CSS**: ユーティリティファーストCSS

#### データ可視化・テーブル
- **Recharts**: React向けチャートライブラリ
- **TanStack Table v8**: 高機能データテーブル

#### ルーティング・状態管理
- **React Router v6**: クライアントサイドルーティング
- **TanStack Query**: サーバー状態管理（Mock API用）

#### ユーティリティ
- **date-fns**: 日付処理
- **clsx**: 条件付きクラス名結合
- **react-hook-form**: フォーム管理
- **zod**: バリデーション

## 3. 機能要件

### 3.1 ダッシュボード（ホーム画面）
#### 概要
店舗運営の全体像を一目で把握できるサマリー画面

#### 表示項目
- **売上サマリーカード**
  - 本日の売上金額
  - 前日比較（％表示）
  - 注文件数
  - 平均単価
  
- **リアルタイム注文状況**
  - 新規注文数（未対応）
  - 調理中の注文数
  - 受取待ちの注文数
  - 完了した注文数
  
- **在庫アラート**
  - 在庫切れ商品リスト
  - 在庫少（5個以下）商品リスト
  
- **人気商品TOP5**
  - 本日の売上個数ランキング
  - 商品名、カテゴリ、売上数

#### レイアウト
- タブレット: 2列グリッドレイアウト
- スマホ: 1列縦スクロール

### 3.2 注文管理
#### 概要
リアルタイムで注文を管理し、ステータスを更新する画面

#### 機能
- **注文リスト**
  - 注文ID、顧客名、注文時刻
  - 注文タイプ（店内/テイクアウト）
  - ステータス（受付中/調理中/受取可能/完了/キャンセル）
  - 合計金額
  
- **ステータス更新**
  - ドラッグ&ドロップまたはボタンクリックで更新
  - ステータス変更時にタイムスタンプ記録
  
- **フィルター機能**
  - ステータス別
  - 注文タイプ別
  - 日付範囲
  
- **注文詳細モーダル**
  - 商品明細（カスタマイズ含む）
  - 顧客情報
  - 注文メモ
  - ステータス履歴

#### 通知機能（Mock）
- 新規注文時に音声通知
- 画面上部にトースト通知

### 3.3 メニュー管理
#### 概要
商品の在庫状況や価格を管理する画面

#### 機能
- **商品一覧**
  - カテゴリ別タブ（ドリンク/フード/デザート/グッズ）
  - 商品画像、名前、価格、在庫状況
  - 検索機能
  
- **在庫管理**
  - 在庫切れトグルスイッチ
  - 在庫数の編集（モック）
  
- **価格管理**
  - インライン編集で価格変更
  - 変更履歴の記録
  
- **商品編集**（モック）
  - 商品情報の編集
  - カスタマイズオプションの管理

### 3.4 顧客管理
#### 概要
ポイントカード会員の管理とポイント操作

#### 機能
- **顧客リスト**
  - 会員ID、名前、メールアドレス
  - 会員ランク（ブロンズ/シルバー/ゴールド）
  - 保有ポイント
  - 最終来店日
  
- **ポイント操作**
  - ポイント付与（レジ連携シミュレート）
  - ポイント使用記録
  - 履歴表示
  
- **顧客詳細**
  - 基本情報
  - 注文履歴
  - お気に入り商品
  - ポイント履歴

### 3.5 売上分析
#### 概要
売上データの可視化と分析

#### 表示内容
- **売上推移グラフ**
  - 日別/週別/月別切り替え
  - 前期間比較
  
- **商品別売上**
  - 円グラフまたは棒グラフ
  - 売上金額/数量切り替え
  
- **時間帯別分析**
  - 24時間の売上分布
  - ピークタイム表示
  
- **カテゴリ別分析**
  - カテゴリ別売上構成比
  - トレンド表示

#### エクスポート機能（モック）
- CSV/PDFダウンロードボタン

### 3.6 設定
#### 店舗情報
- 店舗名、住所、電話番号
- 営業時間（曜日別）
- 定休日設定

#### スタッフ管理（モック）
- スタッフリスト
- 権限設定（管理者/スタッフ）
- ログイン履歴

#### システム設定
- 通知設定（音声ON/OFF）
- データ同期間隔
- 言語設定

## 4. UI/UXデザイン

### 4.1 レイアウト構成
```
タブレット版:
┌─────────────────────────────────────────┐
│ ヘッダー（ロゴ、店舗名、ユーザー情報）       │
├───────────┬─────────────────────────────┤
│           │                             │
│ サイドバー │      メインコンテンツ        │
│           │                             │
│ ・ダッシュ  │                             │
│ ・注文管理  │                             │
│ ・メニュー  │                             │
│ ・顧客管理  │                             │
│ ・売上分析  │                             │
│ ・設定     │                             │
│           │                             │
└───────────┴─────────────────────────────┘

スマホ版:
┌─────────────┐
│  ハンバーガー │
│  メニュー    │
├─────────────┤
│             │
│   メイン     │
│ コンテンツ   │
│             │
└─────────────┘
```

### 4.2 カラーパレット
- **プライマリ**: Slate（グレー系）
- **アクセント**: Blue（情報・アクション）
- **成功**: Green（完了状態）
- **警告**: Yellow（注意・準備中）
- **エラー**: Red（キャンセル・エラー）
- **背景**: Gray-50（明るいグレー）

### 4.3 レスポンシブ対応
#### ブレークポイント
- スマホ: < 768px
- タブレット: >= 768px
- デスクトップ: >= 1024px（オプション）

#### タブレット最適化
- 2カラムレイアウト
- タッチ操作に最適化されたボタンサイズ（最小44px）
- スワイプジェスチャー対応

#### スマホ最適化
- 1カラムレイアウト
- 折りたたみ可能なセクション
- 下部ナビゲーション検討

### 4.4 インタラクション
- **ローディング**: スケルトンスクリーン
- **トランジション**: スムーズなページ遷移
- **フィードバック**: 操作時の視覚的フィードバック
- **エラーハンドリング**: 分かりやすいエラーメッセージ

## 5. 顧客用PWAとの連携

### 5.1 データ同期
- LocalStorageを介したデータ共有
- 注文データのリアルタイム反映（ポーリング）
- ポイント付与の即時反映

### 5.2 連携デモシナリオ
1. 顧客がPWAで注文
2. 管理画面に新規注文通知
3. スタッフがステータス更新
4. 顧客のPWAに状態反映
5. 受取完了でポイント付与

## 6. Mock実装の詳細

### 6.1 データ構造
```typescript
// 注文管理用の拡張型
interface AdminOrder extends Order {
  customerInfo: {
    name: string;
    phone?: string;
    email?: string;
  };
  statusHistory: {
    status: Order['status'];
    timestamp: Date;
    staffId?: string;
  }[];
  preparationTime?: number; // 分
  notes?: string;
}

// スタッフ管理
interface Staff {
  id: string;
  name: string;
  role: 'admin' | 'staff';
  email: string;
  lastLogin?: Date;
}

// 売上データ
interface SalesData {
  date: Date;
  totalAmount: number;
  orderCount: number;
  itemsSold: {
    itemId: string;
    quantity: number;
    revenue: number;
  }[];
}
```

### 6.2 Mock API
```typescript
// shared/utils/adminMockApi.ts
export const adminMockApi = {
  // 注文管理
  async updateOrderStatus(orderId: string, status: Order['status']) {
    // LocalStorageの注文データを更新
    // 通知音を再生
    // 履歴に記録
  },
  
  // 在庫管理
  async updateInventory(itemId: string, inStock: boolean) {
    // メニューアイテムの在庫状態を更新
  },
  
  // 売上データ取得
  async getSalesData(dateRange: { from: Date, to: Date }) {
    // 期間内の売上データを集計して返す
  },
  
  // ポイント操作
  async addPoints(userId: string, points: number, reason: string) {
    // ユーザーのポイントを更新
    // 履歴に記録
  }
};
```

## 7. パフォーマンス最適化

### 7.1 データ管理
- React Queryでのキャッシュ管理
- 最小限のリレンダリング
- 仮想スクロール（大量データ時）

### 7.2 レスポンシブ画像
- 適切なサイズの画像配信
- 遅延読み込み
- WebP形式の使用

## 8. セキュリティ考慮事項（実装時）
- 認証・認可の実装
- XSS対策
- CSRF対策
- データ暗号化

## 9. 今後の拡張可能性
- リアルタイムWebSocket通信
- プリンター連携（レシート印刷）
- POSシステム連携
- 複数店舗管理
- AIによる需要予測

## 10. 開発優先順位
1. **Phase 1**: 基本機能
   - ダッシュボード
   - 注文管理
   - メニュー管理（在庫切れ設定）

2. **Phase 2**: 分析機能
   - 売上分析
   - 顧客管理

3. **Phase 3**: 高度な機能
   - 詳細な設定画面
   - エクスポート機能
   - 通知システムの拡張